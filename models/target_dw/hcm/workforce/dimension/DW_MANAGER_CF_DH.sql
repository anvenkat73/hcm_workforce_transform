 SELECT MHCF.PERSONID AS PERSON_ID, 
 MHCF.ASSIGNMENTID AS ASSIGNMENT_ID, 
 MHCF.EFFECTIVESTARTDATE AS EFFECTIVE_START_DATE, 
 MHCF.EFFECTIVEENDDATE AS EFFECTIVE_END_DATE, 
 MHCF.MANAGERTYPE AS MANAGER_TYPE, 
 MHCF.ENTERPRISEID AS ENTERPRISE_ID, 
 MHCF.PERSONID||'~'||MHCF.ASSIGNMENTID||'~'||TO_CHAR(MHCF.EFFECTIVESTARTDATE,'YYYYMMDD')||'~'|| TO_CHAR(MHCF.EFFECTIVEENDDATE,'YYYYMMDD')||'~'||MHCF.MANAGERTYPE||'~'||MHCF.ENTERPRISEID AS SOURCE_RECORD_ID, 
 MHCF.LEVEL1MANAGERID AS LEVEL1_MANAGER_ID, 
 MHCF.LEVEL1MANAGERASSIGNMENTID AS LEVEL1_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL2MANAGERID,-99999) AS LEVEL2_MANAGER_ID, 
 COALESCE( MHCF.LEVEL2MANAGERASSIGNMENTID ,-99999) AS LEVEL2_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL3MANAGERID,-99999) AS LEVEL3_MANAGER_ID, 
 COALESCE( MHCF.LEVEL3MANAGERASSIGNMENTID,-99999) AS LEVEL3_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL4MANAGERID,-99999) AS LEVEL4_MANAGER_ID, 
  COALESCE( MHCF.LEVEL4MANAGERASSIGNMENTID,-99999) AS LEVEL4_MANAGER_ASSIGNMENT_ID, 
  COALESCE( MHCF.LEVEL5MANAGERID,-99999) AS LEVEL5_MANAGER_ID, 
  COALESCE( MHCF.LEVEL5MANAGERASSIGNMENTID,-99999) AS LEVEL5_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL6MANAGERID,-99999) AS LEVEL6_MANAGER_ID, 
  COALESCE( MHCF.LEVEL6MANAGERASSIGNMENTID,-99999) AS LEVEL6_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL7MANAGERID,-99999) AS LEVEL7_MANAGER_ID, 
  COALESCE( MHCF.LEVEL7MANAGERASSIGNMENTID,-99999) AS LEVEL7_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL8MANAGERID,-99999) AS LEVEL8_MANAGER_ID, 
  COALESCE( MHCF.LEVEL8MANAGERASSIGNMENTID,-99999) AS LEVEL8_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL9MANAGERID,-99999) AS LEVEL9_MANAGER_ID, 
 COALESCE( MHCF.LEVEL9MANAGERASSIGNMENTID,-99999) AS LEVEL9_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL10MANAGERID,-99999) AS LEVEL10_MANAGER_ID, 
 COALESCE( MHCF.LEVEL10MANAGERASSIGNMENTID,-99999) AS LEVEL10_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL11MANAGERID,-99999) AS LEVEL11_MANAGER_ID, 
 COALESCE( MHCF.LEVEL11MANAGERASSIGNMENTID,-99999) AS LEVEL11_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL12MANAGERID,-99999) AS LEVEL12_MANAGER_ID, 
 COALESCE( MHCF.LEVEL12MANAGERASSIGNMENTID,-99999) AS LEVEL12_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL13MANAGERID,-99999) AS LEVEL13_MANAGER_ID, 
 COALESCE( MHCF.LEVEL13MANAGERASSIGNMENTID,-99999) AS LEVEL13_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL14MANAGERID,-99999) AS LEVEL14_MANAGER_ID, 
 COALESCE( MHCF.LEVEL14MANAGERASSIGNMENTID,-99999) AS LEVEL14_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL15MANAGERID,-99999) AS LEVEL15_MANAGER_ID, 
 COALESCE( MHCF.LEVEL15MANAGERASSIGNMENTID,-99999) AS LEVEL15_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL16MANAGERID,-99999) AS LEVEL16_MANAGER_ID, 
 COALESCE( MHCF.LEVEL16MANAGERASSIGNMENTID,-99999) AS LEVEL16_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL17MANAGERID,-99999) AS LEVEL17_MANAGER_ID, 
 COALESCE( MHCF.LEVEL17MANAGERASSIGNMENTID,-99999) AS LEVEL17_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL18MANAGERID,-99999) AS LEVEL18_MANAGER_ID, 
 COALESCE( MHCF.LEVEL18MANAGERASSIGNMENTID,-99999) AS LEVEL18_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL19MANAGERID,-99999) AS LEVEL19_MANAGER_ID, 
 COALESCE( MHCF.LEVEL19MANAGERASSIGNMENTID,-99999) AS LEVEL19_MANAGER_ASSIGNMENT_ID, 
 COALESCE( MHCF.LEVEL20MANAGERID,-99999) AS LEVEL20_MANAGER_ID, 
 COALESCE( MHCF.LEVEL20MANAGERASSIGNMENTID,-99999) AS LEVEL20_MANAGER_ASSIGNMENT_ID, 
 GREATEST(TO_DATE(SUBSTR('$VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE$',1,19),'YYYY-MM-DD HH24:MI:SS'),MHCF.EFFECTIVESTARTDATE) AS DW_DATE_FROM, 
 MHCF.EFFECTIVEENDDATE AS DW_DATE_TO, 
  CASE WHEN TO_DATE(SUBSTR('$VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE$',1,19),'YYYY-MM-DD HH24:MI:SS') > MHCF.EFFECTIVESTARTDATE  THEN 1 ELSE 0 END AS DW_INITIAL_RECORD_IND
 FROM {{ ref('stg_h_managerhierarchyam_managerhrchybottomuppvolinemanager') }} MHCF

