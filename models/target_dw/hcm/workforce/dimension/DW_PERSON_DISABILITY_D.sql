 SELECT  	PERSONDISABILITY.DISABILITYID AS PERSON_DISABILITY_ID	 , 
 	PERSONDISABILITY.EFFECTIVESTARTDATE AS EFFECTIVE_START_DATE	, 
 	PERSONDISABILITY.EFFECTIVEENDDATE AS EFFECTIVE_END_DATE	, 
  	TO_CHAR(PERSONDISABILITY.DISABILITYID)||'~'||TO_CHAR(PERSONDISABILITY.EFFECTIVESTARTDATE,'YYYYMMDD')||'~'||TO_CHAR(PERSONDISABILITY.EFFECTIVEENDDATE,'YYYYMMDD') AS SOURCE_RECORD_ID	 , 
 	PERSONDISABILITY.PERSONDISABILITYPEOPERSONID AS PERSON_ID	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOLEGISLATIONCODE AS LEGISLATION_CODE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOORGANIZATIONID AS DISABILITY_ORGANIZATION_ID	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOREGISTRATIONID AS REGISTRATION_ID	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOREGISTRATIONDATE AS REGISTRATION_DATE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOREGISTRATIONEXPDATE AS REGISTRATION_EXP_DATE	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOCATEGORY,'~NOVALUE~') AS DISABILITY_CATEGORY	, 
 		PERSONDISABILITY.PERSONDISABILITYPEODESCRIPTION AS DISABILITY_DESCRIPTION	, 
 		PERSONDISABILITY.PERSONDISABILITYPEODEGREE AS DISABILITY_DEGREE	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOREASON,'~NOVALUE~') AS DISABILITY_REASON	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOWORKRESTRICTION AS WORK_RESTRICTION	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOSTATUS,'~NOVALUE~') AS DISABILITY_STATUS	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOSELFDISCLOSEDTYPE,'~NOVALUE~') AS SELF_DISCLOSED_TYPE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEODISCLOSUREDATE AS DISCLOSURE_DATE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOACCOMMODATIONREQUEST AS ACCOMMODATION_REQUEST	, 
  GREATEST(TO_DATE(SUBSTR('$VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE$',1,19),'YYYY-MM-DD HH24:MI:SS'),PERSONDISABILITY.EFFECTIVESTARTDATE) AS DW_DATE_FROM , 
  PERSONDISABILITY.EFFECTIVEENDDATE AS DW_DATE_TO , 
  CASE WHEN TO_DATE(SUBSTR('$VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE$',1,19),'YYYY-MM-DD HH24:MI:SS') > PERSONDISABILITY.EFFECTIVESTARTDATE  THEN 1 ELSE 0 END AS DW_INITIAL_RECORD_IND 
 FROM {{ ref('stg_h_personam_persondisabilitypvo') }} PERSONDISABILITY

