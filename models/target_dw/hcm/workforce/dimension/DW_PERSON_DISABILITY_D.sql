 SELECT  	PERSONDISABILITY.DISABILITYID AS PERSON_DISABILITY_ID	 , 
 	PERSONDISABILITY.EFFECTIVESTARTDATE AS EFFECTIVE_START_DATE	, 
 	PERSONDISABILITY.EFFECTIVEENDDATE AS EFFECTIVE_END_DATE	, 
  	CAST(PERSONDISABILITY.DISABILITYID AS STRING)||'~'||FORMAT_DATE('%Y%m%d', PARSE_DATE('%Y-%m-%d', PERSONDISABILITY.EFFECTIVESTARTDATE))||'~'||FORMAT_DATE('%Y%m%d', PARSE_DATE('%Y-%m-%d', PERSONDISABILITY.EFFECTIVEENDDATE)) AS SOURCE_RECORD_ID	 , 
 	PERSONDISABILITY.PERSONDISABILITYPEOPERSONID AS PERSON_ID	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOLEGISLATIONCODE AS LEGISLATION_CODE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOORGANIZATIONID AS DISABILITY_ORGANIZATION_ID	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOREGISTRATIONID AS REGISTRATION_ID	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOREGISTRATIONDATE AS REGISTRATION_DATE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOREGISTRATIONEXPDATE AS REGISTRATION_EXP_DATE	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOCATEGORY,'~NOVALUE~') AS DISABILITY_CATEGORY	, 
 		PERSONDISABILITY.PERSONDISABILITYPEODESCRIPTION AS DISABILITY_DESCRIPTION	, 
 		PERSONDISABILITY.PERSONDISABILITYPEODEGREE AS DISABILITY_DEGREE	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOREASON,'~NOVALUE~') AS DISABILITY_REASON	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOWORKRESTRICTION AS WORK_RESTRICTION	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOSTATUS,'~NOVALUE~') AS DISABILITY_STATUS	, 
 		COALESCE(PERSONDISABILITY.PERSONDISABILITYPEOSELFDISCLOSEDTYPE,'~NOVALUE~') AS SELF_DISCLOSED_TYPE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEODISCLOSUREDATE AS DISCLOSURE_DATE	, 
 		PERSONDISABILITY.PERSONDISABILITYPEOACCOMMODATIONREQUEST AS ACCOMMODATION_REQUEST	, 
  CASE WHEN PARSE_DATE('%Y-%m-%d', '{{ var("VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE") }}') > PARSE_DATE('%Y-%m-%d', PERSONDISABILITY.EFFECTIVESTARTDATE ) THEN PARSE_DATE('%Y-%m-%d', '{{ var("VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE") }}') ELSE PARSE_DATE('%Y-%m-%d', PERSONDISABILITY.EFFECTIVESTARTDATE) END AS DW_DATE_FROM , 
  PERSONDISABILITY.EFFECTIVEENDDATE AS DW_DATE_TO , 
  CASE WHEN PARSE_DATE('%Y-%m-%d', '{{ var("VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE") }}') > PARSE_DATE('%Y-%m-%d', PERSONDISABILITY.EFFECTIVESTARTDATE)  THEN 1 ELSE 0 END AS DW_INITIAL_RECORD_IND 
 FROM {{ ref('stg_h_personam_persondisabilitypvo') }} PERSONDISABILITY

