 SELECT  	PERSONNAME.PERSONNAMEID AS PERSON_NAME_ID	 , 
 	PERSONNAME.EFFECTIVESTARTDATE AS EFFECTIVE_START_DATE	, 
 	PERSONNAME.EFFECTIVEENDDATE AS EFFECTIVE_END_DATE	, 
  	TO_CHAR(PERSONNAME.PERSONNAMEID)||'~'||TO_CHAR(PERSONNAME.EFFECTIVESTARTDATE,'YYYYMMDD')||'~'||TO_CHAR(PERSONNAME.EFFECTIVEENDDATE,'YYYYMMDD') AS SOURCE_RECORD_ID	 , 
 	PERSONNAME.PERSONNAMEPEOPERSONID AS PERSON_ID	, 
 		PERSONNAME.PERSONNAMEPEOLEGISLATIONCODE AS LEGISLATION_CODE	, 
 		PERSONNAME.PERSONNAMEPEONAMETYPE AS NAME_TYPE	, 
 		PERSONNAME.PERSONNAMEPEODISPLAYNAME AS DISPLAY_NAME	, 
 		PERSONNAME.PERSONNAMEPEOFIRSTNAME AS FIRST_NAME	, 
 		PERSONNAME.PERSONNAMEPEOLASTNAME AS LAST_NAME	, 
 		PERSONNAME.PERSONNAMEPEOMIDDLENAMES AS MIDDLE_NAMES	, 
 		PERSONNAME.PERSONNAMEPEOTITLE AS TITLE	, 
 		PERSONNAME.PERSONNAMEPEOPRENAMEADJUNCT AS PRE_NAME_ADJUNCT	, 
 		PERSONNAME.PERSONNAMEPEOSUFFIX AS SUFFIX	, 
 		PERSONNAME.PERSONNAMEPEOKNOWNAS AS KNOWN_AS	, 
 		PERSONNAME.PERSONNAMEPEOPREVIOUSLASTNAME AS PREVIOUS_LAST_NAME	, 
 	PERSONNAME.PERSONNAMEPEOFULLNAME AS FULL_NAME	, 
 	PERSONNAME.PERSONNAMEPEOLISTNAME AS LIST_NAME	, 
 	PERSONNAME.PERSONNAMEPEOORDERNAME AS ORDER_NAME	, 
 GREATEST(TO_DATE(SUBSTR('$VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE$',1,19),'YYYY-MM-DD HH24:MI:SS'),PERSONNAME.EFFECTIVESTARTDATE) AS DW_DATE_FROM, 
 PERSONNAME.EFFECTIVEENDDATE AS DW_DATE_TO, 
  CASE WHEN TO_DATE(SUBSTR('$VAR_PARAM_GLOBAL_INITIAL_EXTRACT_DATE$',1,19),'YYYY-MM-DD HH24:MI:SS') > PERSONNAME.EFFECTIVESTARTDATE  THEN 1 ELSE 0 END AS DW_INITIAL_RECORD_IND
 FROM {{ ref('stg_h_personam_personnamepvoviewall') }} PERSONNAME

