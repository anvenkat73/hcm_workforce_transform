 SELECT DAY.CAL_MONTH_ID AS CAL_MONTH_ID, 
 DAY.CAL_MONTH_ID AS SOURCE_RECORD_ID, 
 DAY.CAL_QUARTER_ID AS CAL_QUARTER_ID, 
 DAY.CAL_YEAR_ID AS CAL_YEAR_ID, 
 DAY.CAL_MONTH_CODE AS CAL_MONTH_CODE, 
 DAY.CAL_QUARTER_CODE AS CAL_QUARTER_CODE, 
 DAY.CAL_MONTH_START_DATE AS CAL_MONTH_START_DATE, 
 DAY.CAL_MONTH_END_DATE AS CAL_MONTH_END_DATE, 
 DAY.CAL_QUARTER_START_DATE AS CAL_QUARTER_START_DATE, 
 DAY.CAL_QUARTER_END_DATE AS CAL_QUARTER_END_DATE, 
 DAY.CAL_YEAR_START_DATE AS CAL_YEAR_START_DATE, 
 DAY.CAL_YEAR_END_DATE AS CAL_YEAR_END_DATE, 
 DAY.CAL_MONTH_NUMBER AS CAL_MONTH_NUMBER, 
 DAY.CAL_HALF_NUMBER AS CAL_HALF_NUMBER, 
 DAY.CAL_QUARTER_NUMBER AS CAL_QUARTER_NUMBER, 
 DAY.CAL_TRIMESTER_NUMBER AS CAL_TRIMESTER_NUMBER, 
 DAY.CAL_MONTH_END_DATE_ID AS CAL_MONTH_END_DATE_ID, 
 DAY.CAL_MONTH_START_DATE_ID AS CAL_MONTH_START_DATE_ID, 
 DAY.CAL_QUARTER_START_DATE_ID AS CAL_QUARTER_START_DATE_ID, 
 DAY.CAL_QUARTER_END_DATE_ID AS CAL_QUARTER_END_DATE_ID, 
 DAY.CAL_YEAR_END_DATE_ID AS CAL_YEAR_END_DATE_ID, 
 DAY.CAL_YEAR_START_DATE_ID AS CAL_YEAR_START_DATE_ID, 
 MAX(CASE WHEN DAY.CAL_MONTH_START_DATE=DAY.CAL_QUARTER_START_DATE THEN 'Y' ELSE 'N' END) AS FIRST_MONTH_CAL_QTR_FLAG, 
 MAX(CASE WHEN DAY.CAL_MONTH_END_DATE=DAY.CAL_QUARTER_END_DATE THEN 'Y' ELSE 'N' END) AS LAST_MONTH_CAL_QTR_FLAG, 
 MAX(CASE WHEN DAY.CAL_MONTH_START_DATE=DAY.CAL_YEAR_START_DATE THEN 'Y' ELSE 'N' END) AS FIRST_MONTH_CAL_YEAR_FLAG, 
 MAX(CASE WHEN DAY.CAL_MONTH_END_DATE=DAY.CAL_YEAR_END_DATE THEN 'Y' ELSE 'N' END) AS LAST_MONTH_CAL_YEAR_FLAG, 
 DAY.CURRENT_CAL_MONTH_CODE AS CURRENT_CAL_MONTH_CODE, 
 DAY.CURRENT_CAL_QTR_CODE AS CURRENT_CAL_QTR_CODE, 
 DAY.CURRENT_CAL_YEAR_CODE AS CURRENT_CAL_YEAR_CODE, 
 DAY.MONTH_END_OR_PRV_CRNT_DATE AS MONTH_END_OR_PRV_CRNT_DATE
 FROM {{ ref('DW_DAY_D') }} day
 GROUP BY DAY.CAL_MONTH_ID,DAY.CAL_MONTH_ID,DAY.CAL_QUARTER_ID,DAY.CAL_YEAR_ID,DAY.CAL_MONTH_CODE,DAY.CAL_QUARTER_CODE,DAY.CAL_MONTH_START_DATE,DAY.CAL_MONTH_END_DATE,DAY.CAL_QUARTER_START_DATE,DAY.CAL_QUARTER_END_DATE,DAY.CAL_YEAR_START_DATE,DAY.CAL_YEAR_END_DATE,DAY.CAL_MONTH_NUMBER,DAY.CAL_HALF_NUMBER,DAY.CAL_QUARTER_NUMBER,DAY.CAL_TRIMESTER_NUMBER,DAY.CAL_MONTH_END_DATE_ID,DAY.CAL_MONTH_START_DATE_ID,DAY.CAL_QUARTER_START_DATE_ID,DAY.CAL_QUARTER_END_DATE_ID,DAY.CAL_YEAR_END_DATE_ID,DAY.CAL_YEAR_START_DATE_ID,DAY.CURRENT_CAL_MONTH_CODE,DAY.CURRENT_CAL_QTR_CODE,DAY.CURRENT_CAL_YEAR_CODE,DAY.MONTH_END_OR_PRV_CRNT_DATE
