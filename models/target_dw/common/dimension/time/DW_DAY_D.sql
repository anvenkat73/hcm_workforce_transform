 SELECT TO_NUMBER(TO_CHAR(DAY.REPORTDATE,'YYYYMMDD')) AS CAL_DAY_ID, 
 TO_NUMBER(TO_CHAR(DAY.REPORTDATE,'YYYYMMDD')) AS SOURCE_RECORD_ID, 
 DAY.REPORTDATE AS CALENDAR_DATE, 
 DAY.DAYOFWEEK AS DAY_OF_WEEK, 
 DAY.DAYOFMONTH AS DAY_OF_MONTH, 
 DAY.DAYOFYEAR AS DAY_OF_YEAR, 
 DAY.REPORTDATE-1 AS DAY_AGO_DATE, 
 TO_NUMBER(TO_CHAR(DAY.REPORTDATE-1,'YYYYMMDD')) AS DAY_AGO_ID, 
 TO_CHAR(DAY.REPORTDATE, 'DY') AS DAY_CODE, 
 TO_NUMBER(TO_CHAR(DAY.REPORTDATE ,'J')) AS JULIAN_DAY_NUMBER, 
 WEEK.CALWEEK AS CAL_WEEK_ID, 
 CALMONTH.CALMONTH AS CAL_MONTH_ID, 
 QTR.CALQUARTER AS CAL_QUARTER_ID, 
 YEAR.CALYEAR AS CAL_YEAR_ID, 
 CALMONTH.CALMONTHCODE AS CAL_MONTH_CODE, 
 QTR.CALQUARTERCODE AS CAL_QUARTER_CODE, 
 WEEK.CALWEEKCODE AS CAL_WEEK_CODE, 
 WEEK.CALWEEKSTARTDATE AS CAL_WEEK_START_DATE, 
 WEEK.CALWEEKENDDATE AS CAL_WEEK_END_DATE, 
 CALMONTH.CALMONTHSTARTDATE AS CAL_MONTH_START_DATE, 
 CALMONTH.CALMONTHENDDATE AS CAL_MONTH_END_DATE, 
 QTR.CALQTRSTARTDATE AS CAL_QUARTER_START_DATE, 
 QTR.CALQTRENDDATE AS CAL_QUARTER_END_DATE, 
 YEAR.CALYEARSTARTDATE AS CAL_YEAR_START_DATE, 
 YEAR.CALYEARENDDATE AS CAL_YEAR_END_DATE, 
 EXTRACT(MONTH FROM DAY.REPORTDATE) AS CAL_MONTH_NUMBER, 
 CASE WHEN EXTRACT(MONTH FROM DAY.REPORTDATE)IN(1,2,3,4,5,6) THEN 1 ELSE 2 END AS CAL_HALF_NUMBER, 
 CASE WHEN EXTRACT(MONTH FROM DAY.REPORTDATE)IN(1,2,3) THEN 1 WHEN EXTRACT(MONTH FROM DAY.REPORTDATE)IN(4,5,6) THEN 2 WHEN EXTRACT(MONTH FROM DAY.REPORTDATE)IN(7,8,9) THEN 3 ELSE 4 END AS CAL_QUARTER_NUMBER, 
 CASE WHEN EXTRACT(MONTH FROM DAY.REPORTDATE)IN(1,2,3,4) THEN 1 WHEN EXTRACT(MONTH FROM DAY.REPORTDATE)IN(5,6,7,8) THEN 2 ELSE 3 END AS CAL_TRIMESTER_NUMBER, 
 TO_NUMBER(SUBSTR(WEEK.CALWEEK,5)) AS CAL_WEEK_NUMBER, 
 TO_NUMBER(TO_CHAR(CALMONTH.CALMONTHENDDATE,'YYYYMMDD')) AS CAL_MONTH_END_DATE_ID, 
 TO_NUMBER(TO_CHAR(CALMONTH.CALMONTHSTARTDATE,'YYYYMMDD')) AS CAL_MONTH_START_DATE_ID, 
 TO_NUMBER(TO_CHAR(WEEK.CALWEEKENDDATE,'YYYYMMDD')) AS CAL_WEEK_END_DATE_ID, 
 TO_NUMBER(TO_CHAR(WEEK.CALWEEKSTARTDATE,'YYYYMMDD')) AS CAL_WEEK_START_DATE_ID, 
 TO_NUMBER(TO_CHAR(QTR.CALQTRSTARTDATE,'YYYYMMDD')) AS CAL_QUARTER_START_DATE_ID, 
 TO_NUMBER(TO_CHAR(QTR.CALQTRENDDATE,'YYYYMMDD')) AS CAL_QUARTER_END_DATE_ID, 
 TO_NUMBER(TO_CHAR(YEAR.CALYEARENDDATE,'YYYYMMDD')) AS CAL_YEAR_END_DATE_ID, 
 TO_NUMBER(TO_CHAR(YEAR.CALYEARSTARTDATE,'YYYYMMDD')) AS CAL_YEAR_START_DATE_ID, 
 CASE WHEN DAY.REPORTDATE=WEEK.CALWEEKSTARTDATE THEN 'Y' ELSE 'N' END AS FIRST_DAY_CAL_WEEK_FLAG, 
 CASE WHEN DAY.REPORTDATE=WEEK.CALWEEKENDDATE THEN 'Y' ELSE 'N' END AS LAST_DAY_CAL_WEEK_FLAG, 
 CASE WHEN DAY.REPORTDATE=CALMONTH.CALMONTHSTARTDATE THEN 'Y' ELSE 'N' END AS FIRST_DAY_CAL_MONTH_FLAG, 
 CASE WHEN DAY.REPORTDATE=CALMONTH.CALMONTHENDDATE THEN 'Y' ELSE 'N' END AS LAST_DAY_CAL_MONTH_FLAG, 
 CASE WHEN DAY.REPORTDATE=QTR.CALQTRSTARTDATE THEN 'Y' ELSE 'N' END AS FIRST_DAY_CAL_QTR_FLAG, 
 CASE WHEN DAY.REPORTDATE=QTR.CALQTRENDDATE THEN 'Y' ELSE 'N' END AS LAST_DAY_CAL_QTR_FLAG, 
 CASE WHEN DAY.REPORTDATE=YEAR.CALYEARSTARTDATE THEN 'Y' ELSE 'N' END AS FIRST_DAY_CAL_YEAR_FLAG, 
 CASE WHEN DAY.REPORTDATE=YEAR.CALYEARENDDATE THEN 'Y' ELSE 'N' END AS LAST_DAY_CAL_YEAR_FLAG, 
 CALMONTH.CALMONTHENDDATE AS MONTH_END_OR_PRV_CRNT_DATE, 
 QTR.CALQTRENDDATE AS QUARTER_END_OR_PRV_CRNT_DATE, 
 YEAR.CALYEARENDDATE AS YEAR_END_OR_PRV_CRNT_DATE
 FROM  {{ ref('stg_h_gregoriancalendaram_fndcalday') }} DAY 
       INNER JOIN {{ ref('stg_h_gregoriancalendaram_fndcalmonth') }} CALMONTH  ON DAY.REPORTDATE >=CALMONTH.CALMONTHSTARTDATE AND DAY.REPORTDATE<=CALMONTH.CALMONTHENDDATE 
       INNER JOIN  {{ ref('stg_h_gregoriancalendaram_fndcalquarter') }} QTR  ON DAY.REPORTDATE >=QTR.CALQTRSTARTDATE AND DAY.REPORTDATE<=QTR.CALQTRENDDATE 
       INNER JOIN  {{ ref('stg_h_gregoriancalendaram_fndcalweek') }} WEEK  ON DAY.REPORTDATE >=WEEK.CALWEEKSTARTDATE AND DAY.REPORTDATE<=WEEK.CALWEEKENDDATE 
       INNER JOIN  {{ ref('stg_h_gregoriancalendaram_fndcalyear') }} YEAR  ON DAY.REPORTDATE >=YEAR.CALYEARSTARTDATE AND DAY.REPORTDATE<=YEAR.CALYEARENDDATE

